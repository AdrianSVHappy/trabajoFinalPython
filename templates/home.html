<!DOCTYPE html>
<html lang="es">  <!-- Declara el tipo de documento HTML5 y especifica que el idioma es espa帽ol -->
<head>
    <meta charset="UTF-8">  <!-- Define la codificaci贸n de caracteres como UTF-8 para admitir caracteres especiales -->
    <title>Inicio</title>  <!-- T铆tulo de la p谩gina que se muestra en la pesta帽a del navegador -->

    <!-- Enlace a la hoja de estilos CSS ubicada en la carpeta "static/css" -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="container">  <!-- Contenedor principal que envuelve todo el contenido de la p谩gina -->
        
        <!-- Cuadro de bienvenida y perfil -->
        <div class="welcome-profile-box">
            <h2>Bienvenido, {{ user.username }}</h2>  <!-- Muestra un mensaje de bienvenida con el nombre de usuario -->
            <div class="profile-links">
                <a href="{{ url_for('profile') }}">Ver mi perfil</a>  <!-- Enlace para ver el perfil del usuario -->
                <a href="{{ url_for('logout') }}">Cerrar sesi贸n</a>  <!-- Enlace para cerrar sesi贸n -->
            </div>
        </div>

        <!-- Espaciado entre el cuadro de perfil y el cuadro de b煤squeda -->
        <div class="search-box">
            <form action="{{ url_for('buscar') }}" method="POST">  <!-- Formulario de b煤squeda de usuarios -->
                <input type="text" name="termino_busqueda" placeholder="Buscar usuario..." required>  <!-- Campo de entrada para buscar usuarios -->
                <button type="submit"></button>  <!-- Bot贸n para enviar la b煤squeda -->
            </form>
        </div>

        <!-- Bot贸n para ver las publicaciones de los usuarios seguidos -->
        <div class="navigation-buttons">
            <a href="{{ url_for('publicaciones_seguidos') }}">
                <button>Ver publicaciones de los seguidos</button>  <!-- Bot贸n que lleva a las publicaciones de los usuarios seguidos -->
            </a>
        </div>

        <!-- Secci贸n para crear una nueva publicaci贸n -->
        <div class="create-post">
            <h3>Crear Publicaci贸n</h3>  <!-- T铆tulo de la secci贸n de creaci贸n de publicaciones -->
            <form method="POST" class="form-container" enctype="multipart/form-data">  <!-- Formulario para crear la publicaci贸n -->
                <textarea name="content" placeholder="Escribe tu publicaci贸n..." required></textarea><br>  <!-- Campo para escribir el contenido de la publicaci贸n -->
                <input type="file" name="photo" accept="image/*">  <!-- Campo para subir una foto a la publicaci贸n -->
                <button type="submit">Publicar</button>  <!-- Bot贸n para publicar la publicaci贸n -->
            </form>
        </div>

        <!-- Secci贸n para mostrar las publicaciones del usuario -->
        <div class="posts-section">
            <h3>Mis publicaciones</h3>  <!-- T铆tulo de la secci贸n de publicaciones del usuario -->
            <div class="posts">
                {% for post in posts %}  <!-- Itera sobre todas las publicaciones del usuario -->
                    <div class="post">
                        <p>
                            <img src="{{ url_for('static', filename='images/' + (post.user.id|string) + '.jpg') if post.user.foto is true else url_for('static', filename='images/default.jpg') }}" 
                                alt="Foto de perfil" class="profile-pic">  <!-- Muestra la foto de perfil del usuario, o una por defecto -->
                            <strong>{{ post.user.nombre }}:</strong> {{ post.texto }}  <!-- Muestra el nombre del usuario y el texto de la publicaci贸n -->
                        </p>

                        {% if post.computed_foto_path %}  <!-- Si la publicaci贸n tiene una foto asociada -->
                            <img src="{{ url_for('static', filename='publicaciones/' + post.computed_foto_path) }}" alt="Foto de la publicaci贸n" class="post-image">  <!-- Muestra la foto de la publicaci贸n -->
                        {% else %}
                            <p><em>No se ha a帽adido ninguna foto a la publicaci贸n.</em></p>  <!-- Mensaje si la publicaci贸n no tiene foto -->
                        {% endif %}

                        <h4>Comentarios</h4>  <!-- T铆tulo para la secci贸n de comentarios -->
                        {% for comment in post.comments %}  <!-- Itera sobre todos los comentarios de la publicaci贸n -->
                            <p>
                                <img src="{{ url_for('static', filename='images/' + (comment.user.id|string) + '.jpg') if comment.user.foto is true else url_for('static', filename='images/default.jpg') }}" 
                                    alt="Foto de perfil" class="comment-pic">  <!-- Muestra la foto de perfil del usuario que hizo el comentario -->
                                <strong>{{ comment.user.nombre }}:</strong> {{ comment.texto }}  <!-- Muestra el nombre del usuario y el texto del comentario -->
                            </p>
                        {% endfor %}

                        <!-- Formulario para agregar un nuevo comentario -->
                        <form method="POST" action="{{ url_for('add_comment', post_id=post.id) }}" class="comment-form">
                            <input type="text" name="comment_text" placeholder="Escribe un comentario..." required>  <!-- Campo de texto para escribir un comentario -->
                            <button type="submit">Comentar</button>  <!-- Bot贸n para enviar el comentario -->
                        </form>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</body>
</html>
